@using Microsoft.AspNetCore.Identity
@using JobHubMVC.Models

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@if (SignInManager.IsSignedIn(User))
{
    <div class="flex items-center space-x-3">
        <button class="relative p-2 text-gray-400 hover:text-gray-600">
            <i class="fas fa-bell"></i>
            <span class="absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-400"></span>
        </button>
        <div class="relative group">
            <button class="flex items-center space-x-2 text-gray-700 hover:text-blue-600">
                <i class="fas fa-user"></i>
                <span class="hidden sm:block">@User.Identity!.Name</span>
            </button>
            <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                @{
                    var currentUser = await UserManager.GetUserAsync(User);
                    var dashboardAction = currentUser?.Role switch
                    {
                        UserRole.Admin => "Index",
                        UserRole.Employer => "Dashboard", 
                        _ => "MyApplications"
                    };
                    var dashboardController = currentUser?.Role switch
                    {
                        UserRole.Admin => "Admin",
                        UserRole.Employer => "Employer",
                        _ => "Application"
                    };
                }
                <a asp-controller="@dashboardController" asp-action="@dashboardAction" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Dashboard</a>
                <a asp-controller="Profile" asp-action="Index" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Hồ sơ cá nhân</a>
                <form asp-controller="Account" asp-action="Logout" method="post" class="block">
                    <button type="submit" class="flex items-center space-x-2 w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Đăng xuất</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
}
else
{
    <div class="flex items-center space-x-4">
        <a asp-controller="Account" asp-action="Login" class="text-gray-700 hover:text-blue-600 font-medium">Đăng nhập</a>
        <a asp-controller="Account" asp-action="Register" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">Đăng ký</a>
    </div>
}